// Generated by CoffeeScript 1.4.0
(function() {

  angular.module('tmg').directive("breadcrumbs", [
    "$cookies", function($cookies) {
      return {
        restrict: "EA",
        templateUrl: 'static/scripts/directives/breadcrumbs.html',
        scope: {
          'init': '&',
          'fetch': '&',
          'list': '=',
          'onroot': '='
        },
        controller: function($scope, $element) {},
        link: function(scope, elm, attrs) {
          var init;
          init = function() {
            var root;
            scope.list = [];
            root = {
              id: 'root',
              name: {
                kz: 'Негізгі бет',
                en: 'Main',
                ru: 'Главная страница'
              }
            };
            return scope.list.push(root);
          };
          init();
          scope.process = function(id) {
            var b, list, _i, _len, _ref;
            if (id === 'root') {
              scope.onroot = true;
              init();
              return scope.fetch();
            } else {
              scope.onroot = false;
              list = [];
              _ref = scope.list;
              for (_i = 0, _len = _ref.length; _i < _len; _i++) {
                b = _ref[_i];
                list.push(b);
                if (b.id === id) {
                  break;
                }
              }
              scope.list = list;
              return scope.fetch({
                id: id
              });
            }
          };
          return scope.$watch(function() {
            return $cookies.get('lng');
          }, function(newvalue, oldvalue) {
            if (newvalue === 'kk' || newvalue === 'kz') {
              return scope.lng = 'kz';
            } else {
              return scope.lng = newvalue;
            }
          });
        }
      };
    }
  ]);

}).call(this);
